import{g as w,r as x,h as I,c as u,_ as C,i as k,j as y,w as b,o as d,a as n,k as S,v as D,l as A,F as R,n as p,t as _,b as E}from"./entry.a64eeef4.js";const T=w({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(e,{slots:t,attrs:c}){const l=x(!1);return I(()=>{l.value=!0}),o=>{var r;if(l.value)return(r=t.default)==null?void 0:r.call(t);const a=t.fallback||t.placeholder;if(a)return a();const s=o.fallback||o.placeholder||"",i=o.fallbackTag||o.placeholderTag||"span";return u(i,c,s)}}});/*! js-cookie v3.0.5 | MIT */function h(e){for(var t=1;t<arguments.length;t++){var c=arguments[t];for(var l in c)e[l]=c[l]}return e}var N={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function m(e,t){function c(o,a,s){if(!(typeof document>"u")){s=h({},t,s),typeof s.expires=="number"&&(s.expires=new Date(Date.now()+s.expires*864e5)),s.expires&&(s.expires=s.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var r in s)s[r]&&(i+="; "+r,s[r]!==!0&&(i+="="+s[r].split(";")[0]));return document.cookie=o+"="+e.write(a,o)+i}}function l(o){if(!(typeof document>"u"||arguments.length&&!o)){for(var a=document.cookie?document.cookie.split("; "):[],s={},i=0;i<a.length;i++){var r=a[i].split("="),v=r.slice(1).join("=");try{var f=decodeURIComponent(r[0]);if(s[f]=e.read(v,f),o===f)break}catch{}}return o?s[o]:s}}return Object.create({set:c,get:l,remove:function(o,a){c(o,"",h({},a,{expires:-1}))},withAttributes:function(o){return m(this.converter,h({},this.attributes,o))},withConverter:function(o){return m(h({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var g=m(N,{path:"/"});const U={data(){return{connection:null,registrationQueue:[],centralMarketData:[],region:g.get("region")||"NA",notificationItemFilters:g.get("notificationItemFilters")||[{id:null,name:"ethereal",enhancement_level:"4"}]}},mounted(){this.countdownInterval=setInterval(this.updateCountdown,1e3)},created(){this.fetchItems()},beforeDestroy(){clearInterval(this.countdownInterval)},methods:{fetchItems(){fetch("https://apiv2.bdolytics.com/en/"+this.region+"/market/central-market-data").then(e=>{e.json().then(t=>{this.centralMarketData=t.data})}),console.log("Starting connection to WebSocket Server"),this.connection=new WebSocket("wss://ws.bdolytics.com/websocket/registration-queue"),this.connection.onmessage=e=>{const t=JSON.parse(e.data);this.registrationQueue=t,this.updateCountdown()},this.connection.onopen=e=>{console.log("Successfully connected to the WebSocket server...");const t=JSON.stringify({region:this.region});this.connection.send(t)},this.connection.onclose=e=>{console.log("Connection to the WebSocket server was closed.")},this.connection.onerror=e=>{console.log("An error occurred while connecting to the WebSocket server.")}},getItemDataById(e){if(!Array.isArray(this.centralMarketData)||this.centralMarketData.length===0)return console.error("Central Market data is not available or empty."),"";const t=this.centralMarketData.find(c=>c.id==e);return t||(console.error("Item with id "+e+" was not found in the Central Market data."),"")},getIcon(e){return("https://cdn.bdolytics.com/img/"+this.getItemDataById(e).icon_image+".webp").toLowerCase()},getName(e){return this.getItemDataById(e).name},getSecondsFromNow(e){const l=new Date(parseInt(e*1e3))-new Date;return Math.floor(l/1e3)},updateCountdown(){this.registrationQueue.forEach(e=>{e.remainingSeconds=this.getSecondsFromNow(e.timestamp)})},getGrade(e){return parseInt(this.getItemDataById(e).grade_type)},getBorderForItem(e){switch(this.getGrade(e)){case 0:return"border-white";case 1:return"border-green-500";case 2:return"border-blue-500";case 3:return"border-yellow-500";case 4:return"border-orange-500";default:return"border-white"}},getEnhancementLevelString(e){switch(parseInt(e)){case 1:return"PRI: ";case 2:return"DUO: ";case 3:return"TRI: ";case 4:return"TET: ";case 5:return"PEN: ";case 16:return"PRI: ";case 17:return"DUO: ";case 18:return"TRI: ";case 19:return"TET: ";case 20:return"PEN: ";default:return""}},handleRegionChange(){this.region=this.region,g.set("region",this.region),this.fetchItems()},isNotificationItem(e){const t=this.getItemDataById(e.item_id);for(const c of this.notificationItemFilters)if(c.id===e.id&&(c.enhancement_level===e.enhancement_level||c.enhancement_level===null)||t.name.toLowerCase().includes(c.name.toLowerCase())&&(c.enhancement_level===e.enhancement_level||c.enhancement_level===null))return!0;return!1}}},B={class:"container mx-auto m-1 rounded-xl w-full h-full"},M=n("p",{class:"text-center surface rounded-2xl p-8"}," Check out the Registration Queue for the Central Market! ",-1),F={class:"surface mt-8 rounded-2xl flex flex-row p-4 py-8 items-center"},j=n("p",{class:""},"Region:",-1),O=n("option",{value:"NA"},"NA",-1),L=n("option",{value:"EU"},"EU",-1),W=n("option",{value:"MENA"},"MENA",-1),P=n("option",{value:"RU"},"RU",-1),Q=n("option",{value:"SEA"},"SEA",-1),z=n("option",{value:"TH"},"TH",-1),G=n("option",{value:"JP"},"JP",-1),J=n("option",{value:"SA"},"SA",-1),V=n("option",{value:"KR"},"KR",-1),H=n("option",{value:"TW"},"TW",-1),K=n("option",{value:"GT"},"GT",-1),q=n("option",{value:"CEU"},"CEU",-1),X=n("option",{value:"CNA"},"CNA",-1),Y=n("option",{value:"CAS"},"CAS",-1),Z=[O,L,W,P,Q,z,G,J,V,H,K,q,X,Y],$={class:"surface py-2 mt-8 rounded-2xl flex flex-row"},ee={class:"flex-1 mx-2"},te={class:"flex flex-col mt-4"},ne=["src"],oe={class:"flex flex-row flex-grow"},re={class:"flex flex-col mx-4 self-center"},se={class:"font-bold"},ce={class:"text-gray-300"},ae={key:0,class:"flex flex-row flex-grow flex-1 justify-end self-center"},ie={class:"w-24 text-center"},le={key:1,class:"flex flex-row flex-grow flex-1 justify-end self-center"},de=n("p",{class:"w-8"},"-",-1),ue=[de];function he(e,t,c,l,o,a){const s=k("font-awesome-icon"),i=T;return d(),y(i,null,{default:b(()=>[n("div",B,[M,n("div",F,[j,S(n("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>o.region=r),onChange:t[1]||(t[1]=(...r)=>a.handleRegionChange&&a.handleRegionChange(...r)),class:"mx-2 surface-light rounded-2xl p-2"},Z,544),[[D,o.region]])]),n("div",$,[n("div",ee,[n("div",te,[(d(!0),u(R,null,A(o.registrationQueue,r=>(d(),u("div",null,[n("div",{class:p(`px-4 py-2 surface-light rounded-2xl mx-2 flex flex-row items-center mb-4 ${a.isNotificationItem(r)?"border-2 border-yellow-500":""}`)},[n("img",{src:a.getIcon(r.item_id),class:p("w-12 h-12 rounded-xl "+a.getBorderForItem(r.item_id)+" border-2")},null,10,ne),n("div",oe,[n("div",re,[n("p",se,_(a.getEnhancementLevelString(r.enhancement_level)+a.getName(r.item_id)),1),n("p",ce,_(parseInt(r.price).toLocaleString()),1)]),r.remainingSeconds!==void 0?(d(),u("div",ae,[n("p",ie,_(r.remainingSeconds),1),E(s,{icon:"fa-solid fa-clock",size:"lg"})])):(d(),u("div",le,ue))])],2)]))),256))])])])])]),_:1})}const ge=C(U,[["render",he]]);export{ge as default};
